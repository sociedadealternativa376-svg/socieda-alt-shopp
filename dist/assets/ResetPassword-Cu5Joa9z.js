import{r as o,u as k,x as E,y as t,j as e}from"./index-Bpz0FMYO.js";import{o as R,s as h,u as A,E as w,a as p,P as I,t as V,v as T}from"./PasswordStrengthIndicator-Bajs4MG3.js";import{B as c}from"./button-DIaYmcs-.js";import{I as g}from"./input-DG_X0Bn_.js";import{L as j}from"./label-0tM5ApCS.js";import{l as F}from"./logo-CU3fsl7Q.js";import{C as z}from"./circle-check-big-D-xxUQSG.js";import{A as B}from"./arrow-left-BhbEz2om.js";import{L as v}from"./lock-B0Pbul_F.js";import{L as D}from"./loader-circle-z9yUUUXF.js";import"./check-C7VJxLvu.js";const O=R({password:h().min(8,"A senha deve ter pelo menos 8 caracteres"),confirmPassword:h()}).refine(a=>a.password===a.confirmPassword,{message:"As senhas não coincidem",path:["confirmPassword"]}),Z=()=>{const[a,b]=o.useState(!1),[l,N]=o.useState(!1),[m,u]=o.useState(!1),[x,y]=o.useState(""),[S,P]=o.useState(!1),n=k(),{updatePassword:C,session:i}=E(),s=A({resolver:V(O),defaultValues:{password:"",confirmPassword:""}});o.useEffect(()=>{if(!i){const r=setTimeout(()=>{i||(t.error("Link inválido ou expirado. Solicite um novo link de redefinição."),n("/auth"))},2e3);return()=>clearTimeout(r)}},[i,n]);const L=async r=>{const f=T(r.password);if(!f.isValid){t.error(f.errors[0]);return}u(!0);try{const{error:d}=await C(r.password);d?t.error(d.message||"Erro ao redefinir senha"):(P(!0),t.success("Senha redefinida com sucesso!"))}catch{t.error("Erro ao redefinir senha. Tente novamente.")}finally{u(!1)}};return S?e.jsxs("div",{className:"min-h-screen bg-background flex flex-col items-center justify-center p-4",children:[e.jsxs("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-primary/10 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-warm-orange/10 rounded-full blur-3xl"})]}),e.jsx("div",{className:"w-full max-w-md relative z-10",children:e.jsxs("div",{className:"bg-card border border-border rounded-2xl p-8 shadow-xl text-center",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("div",{className:"w-16 h-16 rounded-full bg-green-500/20 flex items-center justify-center",children:e.jsx(z,{className:"h-8 w-8 text-green-500"})})}),e.jsx("h1",{className:"text-2xl font-display gradient-text mb-2",children:"Senha Redefinida!"}),e.jsx("p",{className:"text-muted-foreground text-sm mb-6",children:"Sua senha foi alterada com sucesso. Agora você pode fazer login com sua nova senha."}),e.jsx(c,{onClick:()=>n("/"),className:"w-full bg-gradient-to-r from-warm-yellow via-warm-orange to-warm-red hover:opacity-90",children:"Ir para a loja"})]})})]}):e.jsxs("div",{className:"min-h-screen bg-background flex flex-col items-center justify-center p-4",children:[e.jsxs("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-primary/10 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-warm-orange/10 rounded-full blur-3xl"})]}),e.jsxs("div",{className:"w-full max-w-md relative z-10",children:[e.jsxs(c,{variant:"ghost",onClick:()=>n("/auth"),className:"mb-6 text-muted-foreground hover:text-foreground",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Voltar para login"]}),e.jsxs("div",{className:"bg-card border border-border rounded-2xl p-8 shadow-xl",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("img",{src:F,alt:"Logo",className:"h-16 w-auto"})}),e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-2xl font-display gradient-text mb-2",children:"Redefinir Senha"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Digite sua nova senha abaixo"})]}),e.jsxs("form",{onSubmit:s.handleSubmit(L),className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"new-password",children:"Nova Senha"}),e.jsxs("div",{className:"relative",children:[e.jsx(v,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(g,{id:"new-password",type:a?"text":"password",placeholder:"••••••••",className:"pl-10 pr-10",...s.register("password"),onChange:r=>{s.register("password").onChange(r),y(r.target.value)}}),e.jsx("button",{type:"button",onClick:()=>b(!a),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:a?e.jsx(w,{className:"h-4 w-4"}):e.jsx(p,{className:"h-4 w-4"})})]}),s.formState.errors.password&&e.jsx("p",{className:"text-xs text-destructive",children:s.formState.errors.password.message})]}),x&&e.jsx(I,{password:x}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"confirm-new-password",children:"Confirmar Nova Senha"}),e.jsxs("div",{className:"relative",children:[e.jsx(v,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(g,{id:"confirm-new-password",type:l?"text":"password",placeholder:"••••••••",className:"pl-10 pr-10",...s.register("confirmPassword")}),e.jsx("button",{type:"button",onClick:()=>N(!l),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:l?e.jsx(w,{className:"h-4 w-4"}):e.jsx(p,{className:"h-4 w-4"})})]}),s.formState.errors.confirmPassword&&e.jsx("p",{className:"text-xs text-destructive",children:s.formState.errors.confirmPassword.message})]}),e.jsx(c,{type:"submit",className:"w-full bg-gradient-to-r from-warm-yellow via-warm-orange to-warm-red hover:opacity-90",disabled:m,children:m?e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"h-4 w-4 mr-2 animate-spin"}),"Redefinindo..."]}):"Redefinir Senha"})]})]})]})]})};export{Z as default};
